"""
Collection of some utility functions used by services
"""

import logging
import re

logger = logging.getLogger()


def generate_code(name: str, entity_type: str) -> str:
    """
    Generate a code for an entity based on its name. This is used to maintain uniqueness and prevent
    duplicates. (E.g. a duplicate subcategories within a category)

    The code is generated by converting the name to lowercase and replacing spaces with hyphens. Leading and
    trailing spaces are removed, and consecutive spaces are replaced with a single hyphen

    :param name: The name of the entity
    :param entity_type: Name of the entity type e.g. catalogue category/system (Used for logging)
    :return: The generated code for the entity
    """
    logger.info("Generating code for the %s based on its name", entity_type)
    name = name.lower().strip()
    return re.sub(r"\s+", "-", name)


def generate_path(parent_path: str, code: str, entity_type: str) -> str:
    """
    Generate a path for a catalogue category based on its code and the path from its parent

    :param parent_path: The path of the parent catalogue category
    :param code: The code of the catalogue category
    :param entity_type: Name of the entity type e.g. catalogue category/system (Used for logging)
    :return: The generated path for the catalogue category
    """
    logger.info("Generating path for the %s", entity_type)
    return f"{parent_path}{code}" if parent_path.endswith("/") else f"{parent_path}/{code}"
